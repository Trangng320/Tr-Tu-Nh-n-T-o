# -*- coding: utf-8 -*-
"""Trí Tuệ Nhân Tạo 18/10/2022

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1VjCPuWNqVzRMWd4WN4zosb5WUCCSvAVl
"""

#ANN

from keras.datasets import mnist
(train_images, train_labels),(test_images, test_labels) = mnist.load_data()
#train_images.shape
#train_labels.shape
#test_images.shape
test_labels.shape

import matplotlib.pyplot as plt
plt.imshow(train_images[999])
plt.show()
print(train_labels[999])

from keras import models
from keras import layers
model = models.Sequential()
model.add(layers.Dense(512, activation = 'relu', input_shape = (28*28,)))
model.add(layers.Dense(10, activation = 'softmax'))
model.summary()

train_images = train_images.reshape ((60000,28*28))
train_images = train_images.astype('float32')/255
test_images = test_images.reshape ((10000,28*28))
test_images = test_images.astype('float32')/255
train_images.shape

from keras.utils import to_categorical
train_labels = to_categorical (train_labels)
test_labels = to_categorical(test_labels )
train_labels.shape

model.compile(optimizer = 'rmsprop', loss = 'categorical_crossentropy', metrics = ['accuracy'])
model.fit (train_images, train_labels, epochs = 100, batch_size = 128)

test_loss, test_acc = model.evaluate(test_images,test_labels)
print("test accuracy:",test_acc)

from keras.datasets import fashion_mnist
(X_train,Y_train),(X_test,Y_test) = fashion_mnist.load_data()

X_train.shape

Y_train.shape

X_test.shape

Y_test.shape

import matplotlib.pyplot as plt
plt.imshow(X_train[888])
plt.show()
print(X_train[888])

Class_name = ['T-shirt/Top','Trousers','Pullower','Press','Cost','Sandal','Shirt','Sneaker','Bag','Ankle boot']

import matplotlib.pyplot as plt
plt.imshow(X_train[9])
plt.show()
print(Class_name[Y_train[9]])

from keras import models
from keras import layers
model = models.Sequential()
model.add(layers.Dense(512, activation = 'relu', input_shape = (28*28,)))
model.add(layers.Dense(10, activation = 'softmax'))
model.summary()

X_train = X_train.reshape ((60000,28*28))
X_train = X_train.astype('float32')/255
X_test = X_test.reshape ((10000,28*28))
X_test = X_test.astype('float32')/255
X_train.shape

from keras.utils import to_categorical
Y_train = to_categorical (Y_train)
Y_test = to_categorical(Y_test )
Y_train.shape

model.compile(optimizer = 'rmsprop', loss = 'categorical_crossentropy', metrics = ['accuracy'])
model.fit (X_train, Y_train, epochs = 100, batch_size = 128)

test_loss, test_acc = model.evaluate(X_test,Y_test)
print("test accuracy:",test_acc)

from tensorflow.keras.utils import load_img
from keras.utils.image_utils import img_to_array
import numpy as np

url = "bag.jpg"
img = load_img(url,target_size = (28,28))
plt.imshow(img)
img = img.reshape(1,28,28,3)
img_img.astype("float32")
img = img/255
img = img.reshape(1,784)
np.argmax(model.predict(img), axis=1)

